<!doctype html><html class="not-ready lg:text-base" style=--bg:#faf8f1 lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>python property - cjlee38</title>
<meta name=theme-color><meta name=description content="흔히 &ldquo;객체지향&rdquo; 에서는, 객체가 갖고 있는 Field 를 적절하게 외부로 노출시키거나 숨기기 위해, getter/setter를 사용한다. Java 에서는 private 이라는 키워드로 갖고 있는 멤버변수들을 모두 숨기고, 보여줄 내용은 getter 메소드를, 외부에 의해 변경되어도 되는 변수는 setter 메소드를 활용해 데이터를 관리한다. 따라서 직접적으로 변수에 접근하는 것은 원천적으로 금지되어 있고, 메소드 호출을 통해서만 데이터를 조작할 수 있다.
class Person { private String name; private int age; public Person(String name, int age) { this.name = name; this."><meta name=author content="cjlee38"><link rel="preload stylesheet" as=style href=https://cjlee.io/blog/main.min.css><link rel=preload as=image href=https://cjlee.io/blog/theme.png><script defer src=https://cjlee.io/blog/highlight.min.js onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://cjlee.io/blog/favicon.ico><link rel=apple-touch-icon href=https://cjlee.io/blog/apple-touch-icon.png><meta name=generator content="Hugo 0.127.0"><script async src="https://www.googletagmanager.com/gtag/js?id=G-5D28JSQJDK"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-5D28JSQJDK")}</script><meta itemprop=name content="python property"><meta itemprop=description content="흔히 “객체지향” 에서는, 객체가 갖고 있는 Field 를 적절하게 외부로 노출시키거나 숨기기 위해, getter/setter를 사용한다. Java 에서는 private 이라는 키워드로 갖고 있는 멤버변수들을 모두 숨기고, 보여줄 내용은 getter 메소드를, 외부에 의해 변경되어도 되는 변수는 setter 메소드를 활용해 데이터를 관리한다. 따라서 직접적으로 변수에 접근하는 것은 원천적으로 금지되어 있고, 메소드 호출을 통해서만 데이터를 조작할 수 있다.
class Person { private String name; private int age; public Person(String name, int age) { this.name = name; this."><meta itemprop=datePublished content="2021-09-16T22:05:00+00:00"><meta itemprop=dateModified content="2021-09-16T22:05:00+00:00"><meta itemprop=wordCount content="2554"><meta itemprop=keywords content="Null"><meta property="og:url" content="https://cjlee.io/blog/post/python-property/"><meta property="og:site_name" content="cjlee38"><meta property="og:title" content="python property"><meta property="og:description" content="흔히 “객체지향” 에서는, 객체가 갖고 있는 Field 를 적절하게 외부로 노출시키거나 숨기기 위해, getter/setter를 사용한다. Java 에서는 private 이라는 키워드로 갖고 있는 멤버변수들을 모두 숨기고, 보여줄 내용은 getter 메소드를, 외부에 의해 변경되어도 되는 변수는 setter 메소드를 활용해 데이터를 관리한다. 따라서 직접적으로 변수에 접근하는 것은 원천적으로 금지되어 있고, 메소드 호출을 통해서만 데이터를 조작할 수 있다.
class Person { private String name; private int age; public Person(String name, int age) { this.name = name; this."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-09-16T22:05:00+00:00"><meta property="article:modified_time" content="2021-09-16T22:05:00+00:00"><meta property="article:tag" content="Null"><meta name=twitter:card content="summary"><meta name=twitter:title content="python property"><meta name=twitter:description content="흔히 “객체지향” 에서는, 객체가 갖고 있는 Field 를 적절하게 외부로 노출시키거나 숨기기 위해, getter/setter를 사용한다. Java 에서는 private 이라는 키워드로 갖고 있는 멤버변수들을 모두 숨기고, 보여줄 내용은 getter 메소드를, 외부에 의해 변경되어도 되는 변수는 setter 메소드를 활용해 데이터를 관리한다. 따라서 직접적으로 변수에 접근하는 것은 원천적으로 금지되어 있고, 메소드 호출을 통해서만 데이터를 조작할 수 있다.
class Person { private String name; private int age; public Person(String name, int age) { this.name = name; this."><link rel=canonical href=https://cjlee.io/blog/post/python-property/></head><body class="text-black duration-200 ease-out dark:text-white"><header class="mx-auto flex h-[4.5rem] max-w-3xl px-8 lg:justify-center"><div class="relative z-50 mr-auto flex items-center"><a class="-translate-x-[1px] -translate-y-[1px] text-2xl font-semibold" href=https://cjlee.io/blog/>cjlee38</a><div class="btn-dark text-[0] ml-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]" role=button aria-label=Dark></div></div><div class="btn-menu relative z-50 -mr-8 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden" role=button aria-label=Menu></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu.addEventListener("click",()=>{htmlClass.toggle("open")});const metaTheme=document.querySelector('meta[name="theme-color"]'),lightBg="#faf8f1".replace(/"/g,""),setDark=e=>{metaTheme.setAttribute("content",e?"#000":lightBg),htmlClass[e?"add":"remove"]("dark"),localStorage.setItem("dark",e)},darkScheme=window.matchMedia("(prefers-color-scheme: dark)");if(htmlClass.contains("dark"))setDark(!0);else{const e=localStorage.getItem("dark");setDark(e?e==="true":darkScheme.matches)}darkScheme.addEventListener("change",e=>{setDark(e.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script><div class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"><nav class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-6"><a class="block text-center text-2xl leading-[5rem] lg:text-base lg:font-normal" href=/blog/categories/>categories</a>
<a class="block text-center text-2xl leading-[5rem] lg:text-base lg:font-normal" href=/blog/tags/>tags</a></nav></div></header><main class="prose prose-neutral relative mx-auto min-h-[calc(100%-9rem)] max-w-3xl px-8 pb-16 pt-12 dark:prose-invert"><article><header class=mb-16><h1 class="!my-0 pb-2.5">python property</h1><div class="text-sm antialiased opacity-60"><time>Sep 16, 2021</time></div></header><section><p>흔히 &ldquo;객체지향&rdquo; 에서는, 객체가 갖고 있는 <code>Field</code> 를 적절하게 외부로 노출시키거나 숨기기 위해, <code>getter/setter</code>를 사용한다. Java 에서는 <code>private</code> 이라는 키워드로 갖고 있는 멤버변수들을 모두 숨기고, 보여줄 내용은 <code>getter</code> 메소드를, 외부에 의해 변경되어도 되는 변수는 <code>setter</code> 메소드를 활용해 데이터를 관리한다. 따라서 직접적으로 변수에 접근하는 것은 원천적으로 금지되어 있고, 메소드 호출을 통해서만 데이터를 조작할 수 있다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> age;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Person</span>(String name, <span style=color:#66d9ef>int</span> age) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> name;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>getName</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>name</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>getAge</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>age</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setAge</span>(<span style=color:#66d9ef>int</span> age) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (age <span style=color:#f92672>&lt;=</span> 0) 
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> IllegalArgumentException(<span style=color:#e6db74>&#34;나이는 0 이하가 될 수 없다.&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>age</span> <span style=color:#f92672>=</span> age;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Main</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) {
</span></span><span style=display:flex><span>        Person person <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Person(<span style=color:#e6db74>&#34;Mr.Kim&#34;</span>, 26);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(person.<span style=color:#a6e22e>getName</span>()); <span style=color:#75715e>// &#34;Mr.Kim&#34;;</span>
</span></span><span style=display:flex><span>        person.<span style=color:#a6e22e>setAge</span>(<span style=color:#f92672>-</span>62); <span style=color:#75715e>// IllegalArgumentException(&#34;나이는 0 이하가 될 수 없다.&#34;)</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>그러나 python 에서는 programming language 수준에서 접근 권한을 제어할 수 없다. _(언더스코어) 를 활용하는 방법을 제공하기는 하지만, 결국 <code>_{클래스명}__{변수명}</code> 으로 접근이 가능합니다.(이후 뒤에서 설명할 property도 결국 직접 접근하는 방법은 있다.)</p><p>따라서 python 에서는 기본적으로 모두 <code>public</code> 이라고 생각하면 된다. 하지만 그렇다고 해서 <code>getter/setter</code>를 쓸 필요가 없다는 것은 아니다. 당장 위와 같은 예시만 보더라도, <code>setAge()</code> 메소드를 호출할 때, 나이가 음수인지 아닌지 검증하는 로직이 필요하기 때문이다. 위 코드를 python 으로는 다음과 같이 쓸 수 있다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, name, age) :
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_name <span style=color:#f92672>=</span> name
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 다른 메소드는 편의상 생략</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>set_age</span>(self, new_age) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> new_age <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> :
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;나이는 0 이하가 될 수 없다.&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> new_age
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span> :
</span></span><span style=display:flex><span>    person <span style=color:#f92672>=</span> Person(<span style=color:#e6db74>&#34;Mr.Kim&#34;</span>, <span style=color:#ae81ff>26</span>)
</span></span><span style=display:flex><span>    person<span style=color:#f92672>.</span>set_age(<span style=color:#f92672>-</span><span style=color:#ae81ff>62</span>) <span style=color:#75715e># Exception(&#39;나이는 0 이하가 될 수 없다.&#39;)</span>
</span></span></code></pre></div><p>여기까지는 Java와 똑같다. 하지만, 이런 식의 코드 사용은 <code>explicit</code> 하지 못하다는 단점이 있다. 만약 기존 나이에서 1살을 더해줘야 한다면, 다음과 같이 작성해야 한다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>person<span style=color:#f92672>.</span>set_age(person<span style=color:#f92672>.</span>get_age() <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span></code></pre></div><p>뿐만 아니라, <code>person._age = -62</code> 와 같은 코드는 방어할 수가 없어진다는 문제도 여전히 남아있다. 그러나 <code>@property</code> 를 활용하면 다음과 같은 코드가 가능하다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>person<span style=color:#f92672>.</span>age <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>person<span style=color:#f92672>.</span>age <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>62</span> <span style=color:#75715e># Exception(&#39;나이는 0 이하가 될 수 없다.&#39;)</span>
</span></span></code></pre></div><p>??? 어떻게 된 일일까? 겉으로 보기에는 변수에 값을 직접 대입하는 것 같은데, 로직에 따른 Exception을 던지고 있다. 어떻게 이것이 가능한지는 차차 알아보기로 하고, 일단 생김새부터 살펴보자. 위 <code>Person</code> 클래스에 <code>@Property</code>를 적용하면 다음과 같이 작성할 수 있다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, name, age) :
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_name <span style=color:#f92672>=</span> name
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@property</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@age.setter</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self, new_age) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> new_age <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> :
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;나이는 0 이하가 될 수 없다.&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> new_age
</span></span></code></pre></div><p>대충 살펴 봤을때, 눈에 띄는 차이점은 다음과 같다.</p><ol><li>함수의 이름이 <code>get_age</code> 혹은 <code>set_age</code> 가 아니라, 그냥 <code>age</code> 자체로 변경되었다.</li><li>계속 언급했던 <code>@property</code> 가 <code>age</code> 메소드 위에 붙었다. 또한, <code>@age.setter</code> 라는 녀석도 두 번째 <code>age</code> 메소드 위에 붙어있다.</li></ol><p>이러한 변화가 어떻게 앞서 언급했던 동작에 영향을 미쳤는지 하나씩 알아보자.</p><p><code>@property</code>를 이해하기 위한 배경지식들은 다음과 같다.</p><ol><li>Everything is Object</li><li>Decorator</li><li>Descriptor Object</li></ol><h1 id=1-everything-is-object>1. Everything is Object</h1><p>Python에서 다루는 모든 값은 객체이다. Java에서는 일반적으로 값을 <code>Primitive Type</code>, <code>Reference Type</code> 으로 구분한다. 반면 Python에서는 <code>int</code>, <code>bool</code>과 같은 값들도 모두 객체로 다뤄진다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>a <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>print(id(a)) <span style=color:#75715e># 4341049696</span>
</span></span></code></pre></div><p><code>id</code> 함수는 Built-in 함수로, 객체가 가지고 있는 주소값을 나타낸다. 따라서 <code>id(a)</code>라는 코드는 1 이라는 값이 할당된 메모리 주소를 반환한다. Java에서는 <code>Integer</code> 와 비슷하다고 생각할 수 있다.</p><p>이에 더해, Python 에서는 <strong>함수마저도</strong> 객체이다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_func</span>() :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;hello world&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(my_func<span style=color:#f92672>.</span>__str__()) <span style=color:#75715e># &#39;&lt;function my_func at 0x7ffd70cf1f70&gt;&#39;</span>
</span></span></code></pre></div><p>위 예시에서 보시다시피, <code>my_func</code> 이라는 이름의 함수를 만든 뒤, 해당 함수가 갖고 있는 <code>__str__</code> 이라는 메소드를 호출할 수 있다. 즉, <code>my_func</code> 자체는 <code>Function</code> 이라는 클래스를 상속하는 클래스다.</p><p>간단하게 생각하면, <code>def my_func()</code> 라는 키워드는 <code>my_func = {함수 바디}</code> 와 같이 변수로 정의되는 것을 상상해볼 수 있다.</p><blockquote><p>Note. 함수가 객체라는 이야기를 할 때, <code>1급 시민</code> 이라는 키워드가 자주 등장한다. 1급 시민이란, 변수에 할당할 수 있어야 하고, argument로 전달될 수 있으며, return 으로 반환될 수 있는 값들을 말합니다. Java에서 메소드는 일급 객체가 아니지만, 인터페이스를 활용해 1급 시민의 흉내를 낼 수 있다.</p></blockquote><h1 id=2-decorator>2. Decorator</h1><p>데코레이터를 이야기하려면 Python 함수가 갖는 또 다른 특징을 알아야 한다.</p><h2 id=1-함수는-중첩이-가능하다>1) 함수는 중첩이 가능하다.</h2><p>python은 다음과 같이 함수를 중첩해서 정의할 수 있다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>() :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>inner</span>() :
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;inner called&#39;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;outer called&#39;</span>)
</span></span><span style=display:flex><span>    inner()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> inner
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>var <span style=color:#f92672>=</span> outer() <span style=color:#75715e># outer called \n inner called (1)</span>
</span></span><span style=display:flex><span>var() <span style=color:#75715e># inner called (2)</span>
</span></span></code></pre></div><p><code>outer</code> 함수 안에 <code>inner</code> 함수를 정의한 뒤, <code>inner</code> 함수를 호출했다. 따라서 <code>var = outer()</code> 를 통해 <code>outer</code>함수를 호출할 때, 내부에 있는 <code>inner</code> 함수 (1)도 실행된다.</p><p>다음으로 <code>return inner</code>를 통해 <code>inner</code> 함수 그 자체를 돌려주고, 해당 <code>함수 객체</code>는 <code>var</code> 라는 변수에 저장된다. 따라서 <code>var()</code> 를 통해 함수를 실행하는 것은 결국 <code>inner</code> 함수를 실행하는 것과 같다.</p><h2 id=2-enclosed-function-locals>2) Enclosed Function Locals</h2><p>python의 함수가 갖는 두 번째 특징은, 이러한 중첩 함수로 인해 조금 특별한 변수 scope가 생긴다는 것이다. C를 처음 배웠을 무렵, 지역변수 전역변수와 같은 개념에 대해서 배우고, &ldquo;내가 허용된 범위의 바깥 변수는 알 수 없다&rdquo;, &ldquo;가까운 scope부터 찾아 나간다&rdquo; 정도의 개념으로 정리하고 넘어갔다. python에서는 후자, 즉 &ldquo;가까운 scope부터 찾아 나간다"는 맞는 말이지만, 전자인 &ldquo;내가 허용된 범위 바깥 변수는 알 수 없다&rdquo; 는 조금 다르다. 한마디로, &ldquo;내가 허용된 범위 바깥 변수에 접근할 수는 있지만, 수정할 수는 없다.&rdquo;.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>x <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>() :
</span></span><span style=display:flex><span>    y <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>inner</span>() :
</span></span><span style=display:flex><span>        z <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>        print(z, y, x)
</span></span><span style=display:flex><span>    inner()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> inner
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> outer() <span style=color:#75715e># 3 2 1</span>
</span></span><span style=display:flex><span>a() <span style=color:#75715e># 3 2 1</span>
</span></span></code></pre></div><p>아까 예시를 들었던 <code>outer/inner</code> 함수를 약간 변형해보았다. <code>outer</code> 함수가 실행되던 와중에 <code>inner</code>가 호출되든, 함수 객체를 return 받은 <code>a</code>가 호출되든 상관없이, 모두 3 2 1을 출력한다.</p><blockquote><p>Note. python에서는 가까운 곳부터 찾아나가는 접근법을 <strong>LEGB 규칙</strong> 이라고 명명한다. 순서대로 Local, Enclosed function locals, Global, Built-in 의 약자이며, <code>z</code>, <code>y</code>, <code>x</code> 변수가 이에 해당한다. 마지막 Built-in 변수는 __name__과 같이 &ldquo;내가 정의하지도 않았는데 기존에 정의되어 있던 값들"을 말한다.</p></blockquote><p>하지만 다음의 예시는 쓰기에 대해서는 조금 다른 결과임을 보여준다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>x <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>() :
</span></span><span style=display:flex><span>    y <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>inner</span>() :
</span></span><span style=display:flex><span>        z <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>        y <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span> <span style=color:#75715e># UnboundLocalError: local variable &#39;y&#39; referenced before assignment</span>
</span></span><span style=display:flex><span>        x <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span> <span style=color:#75715e># UnboundLocalError: local variable &#39;x&#39; referenced before assignment</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        print(z, y, x)
</span></span><span style=display:flex><span>    inner()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> inner
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> outer()
</span></span><span style=display:flex><span>a()
</span></span></code></pre></div><p><code>inner</code> 내부에서 <code>y</code>와 <code>x</code>에 대해서 값을 1씩 더하려고 하자 할당되기 전에 참조되었다는 에러를 발생시킨다. 즉, 자기 자신의 scope 바깥에 있는 변수에 대해서는 &ldquo;쓰기&rdquo; 연산에 대해, 즉 &ldquo;변경"에 대해 제한되어 있다.</p><blockquote><p>Note. 만약 해당 값을 수정하고 싶다면 <code>nonlocal</code> 혹은 <code>global</code> 키워드를 통해 &ldquo;내가 외부의 값을 수정하고자 한다&rdquo; 라는 의도를 드러내야 한다.</p></blockquote><h2 id=3-closure>3) Closure</h2><p>Closure는 위키피디아에서 다음과 같이 설명하고 있다.</p><pre tabindex=0><code>컴퓨터 언어에서 클로저(Closure)는 일급 객체 함수(first-class functions)의 개념을 이용하여 스코프(scope)에 묶인 변수를 바인딩 하기 위한 일종의 기술이다.
</code></pre><p>이러한 설명은 처음 Closure를 접한 사람들에게 전혀 도움이 되지 않다. 심지어 <code>Closure</code>라는 네이밍 그 자체에서도 어떠한 힌트를 얻기는 어렵다. 예시를 살펴보면서 이해해보자.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>(val) :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>inner</span>() :
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;inner called&#39;</span>)
</span></span><span style=display:flex><span>        print(val)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;outer called&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> inner
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> outer(<span style=color:#ae81ff>10</span>) <span style=color:#75715e># ???</span>
</span></span><span style=display:flex><span>a() <span style=color:#75715e># ???</span>
</span></span></code></pre></div><p>첫 번째로 실행한 <code>a = outer(10)</code>, 두 번째로 실행한 <code>a()</code> 코드가 각각 어떻게 돌아갈지 한번 상상해보자.</p><p><code>a = outer(10)</code>에 의해 <code>outer</code> 함수를 호출했고, argument로 <code>10</code>을 넘겨주고, 이를 val 이라는 이름으로 받아냈다. 그 내부에서 <code>inner</code> 함수를 정의했고, <code>outer called</code> 를 출력한 뒤, <code>inner</code> 함수 객체를 돌려준다.</p><p>두 번째로 <code>a()</code> 를 통해, <code>a</code> 변수가 갖고 있는 <code>inner</code> 함수 객체를 호출한다. <code>inner called</code>를 출력한 뒤, <code>val</code>을 출력하려고 하는데, <strong>여기서 의문점이 하나 생긴다.</strong> 해당 함수는 자신 바깥에 있는, 즉 <code>val</code> 변수를 참조하고 있다. 앞서 이야기한 <code>LEGB 규칙</code>에 따르면, <code>L</code> 에서 <code>E</code>를 참조하는 셈이다.</p><p>여기서 <code>val</code>은 살아 있을까? 바꿔말하면, <code>val</code> 변수를 참조해서 아까 넣어준 <code>10</code> 이라는 값을 얻어낼 수 있을까? 정답은 <strong>&ldquo;그렇다&rdquo;</strong> 입니다.</p><p>이렇게 보니 마치 <code>outer</code> 라는 클래스가 <code>val</code> 이라는 멤버변수를 가지고 있는 것처럼 느껴진다. 여기까지 읽고 나서, 다시 위키피디아의 정의를 살펴보자.</p><pre tabindex=0><code>컴퓨터 언어에서 클로저(Closure)는 일급 객체 함수(first-class functions)의 개념을 이용하여 스코프(scope)에 묶인 변수를 바인딩 하기 위한 일종의 기술이다.
</code></pre><p>이렇게 보니 100% 이해하지는 못하더라도, 어떤 느낌으로 설명하고 있는지는 알 수 있다. <code>Closure</code>라는 이름 또한 직역 시 &ldquo;폐쇄&rdquo; 라는 뜻을 갖고 있는데, 조금 과장해서 &ldquo;나만의 구역"과 같은 느낌이 연상되기도 한다.</p><blockquote><p>Note. 어떠한 함수 A 가 Closure이기 위해서는 다음의 세 가지 조건이 만족되어야 한다.</p><ol><li>A 함수는 다른 함수 B 안에 정의된 함수, 즉 중첩된 함수여야 한다.</li><li>자신을 둘러싼 함수 B scope 의 값을 참조해야 한다.</li><li>B 함수는 A 함수를 반환해야 한다.</li></ol></blockquote><p>여기서 한 단계 더 나아가보자.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>(func) :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>inner</span>() :
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;inner called&#39;</span>)
</span></span><span style=display:flex><span>        func()
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;outer called&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> inner
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_func</span>() :
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;my_func called&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> outer(my_func) <span style=color:#75715e># outer called</span>
</span></span><span style=display:flex><span>a() <span style=color:#75715e># inner called \n my_func called</span>
</span></span></code></pre></div><p>앞서는 <code>val</code> 이라는 숫자 값을 넣어줬지만, 이번에는 <code>my_func</code> 이라는 함수를 넣어주고 있다. 거듭 반복해서 확인할 수 있듯이, 함수 또한 객체이기 떄문에(a.k.a 1급 시민) 다른 함수의 argument로 전달될 수 있다.</p><p>여기서는 <code>outer</code> 라는 함수의 argument로 <code>my_func</code>을 전달하고 있고, 좀 전과 마찬가지로 <code>my_func</code>는 <code>outer</code> 함수의 호출이 끝나더라도 <code>inner</code>에 의해 참조되고 있다.</p><h2 id=4-decorator-정리>4) Decorator 정리</h2><p><code>Decorator</code>를 알기 위한 사전 지식은 준비되었으니, 이제 본격적으로 알아보자.</p><p>바로 위의 예시에서는 <code>a = outer(my_func)</code> 라는 함수를 통해 closure를 만들고, <code>a()</code> 를 통해 <code>inner</code> 함수, 즉 closure 를 호출했다. Decorator를 활용하면 이를 보다 손쉽게 정의할 수 있다.</p><p>즉, 다음의 두 코드는 같다.</p><p>기존</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>(func) :
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_func</span>() :
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> outer(my_func) <span style=color:#75715e># outer called</span>
</span></span><span style=display:flex><span>a() <span style=color:#75715e># inner called \n my_func called</span>
</span></span></code></pre></div><p>데코레이터</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>outer</span>(func) :
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@outer</span>  <span style=color:#75715e># outer called</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_func</span>() :
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> my_func() <span style=color:#75715e># inner called \n my_func called </span>
</span></span></code></pre></div><p>여기서 한 가지 주의할 점은, 데코레이터 버전에서 <code>outer called</code> 는 <code>@outer</code>를 붙여서 <code>my_func</code>를 정의하는 시점에 호출된다는 점이다. 이렇게 보면 <code>Decorator</code> 라는 이름이 왜 <code>Decorator</code> 인지 알 수 있다.</p><h1 id=3-descriptor-object>3. Descriptor Object</h1><p>Descriptor 는 객체 A가 갖고있는 속성인 객체 B를 다룰 때 조회, 저장 및 삭제를 사용자 정의할 수 있는 객체 B를 디스크립터라고 이야기한다. 이 Descriptor라는 녀석은 객체 A의 클래스 변수로서 정의되어야 한다. (<em>the descriptor must be in either the owner’s class dictionary or in the class dictionary for one of its parents</em>)</p><p>역시, 예시를 보면서 진행하겠다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Age</span> :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, age) :
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> age
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __get__(self, obj, objtype) :
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;__get__ method called&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __set__(self, obj, val) :
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;__set__ method called&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> val
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __delete__(self, obj) :
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;__delete__ method called&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> :
</span></span><span style=display:flex><span>    age <span style=color:#f92672>=</span> Age(<span style=color:#ae81ff>26</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> Person()
</span></span><span style=display:flex><span>print(p<span style=color:#f92672>.</span>age) <span style=color:#75715e># __get__ method called \n 26</span>
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>age <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span> <span style=color:#75715e># __set__ method called</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>del</span> p<span style=color:#f92672>.</span>age <span style=color:#75715e># __delete__ method called</span>
</span></span><span style=display:flex><span>print(p<span style=color:#f92672>.</span>age) <span style=color:#75715e># __get__method called \n -1</span>
</span></span></code></pre></div><p>Age 라는 클래스를 만들고, <code>__get__</code>, <code>__set__</code>, <code>__delete__</code> 메소드를 정의했다. 이 세개의 메소드는 <strong>스페셜 메소드</strong> 라고 불리우며, 객체가 갖는 특성을 지정할 수 있다. 가장 대표적으로 <code>__init__</code> 메소드는 인스턴스 생성시에 동작하는 행위에 대해서 정의할 수 있다.</p><p>어떠한 객체에 위에서 언급한 세 개의 <code>__get__</code>, <code>__set__</code>, <code>__delete__</code> 메소드가 정의되었을 경우, 해당 객체를 &ldquo;디스크립터&rdquo; 라고 부르게 된다.</p><blockquote><p>Note. <code>__get__</code> 메소드만 정의된 경우에는 <code>Non-data Descriptor</code>, <code>__set__</code> 메소드 혹은 <code>__delete__</code> 메소드가 정의된 경우에는 <code>Data Descriptor</code> 라고 부른다. 이 둘의 차이는 우선순위에 있다만, 여기서는 다룰 내용이 아닌지라 넘어가겠다.</p></blockquote><p>이렇게 Descriptor를 정의할 경우, 해당 객체로 접근할 때 우리가 생각했던 것처럼 값에 직접 접근하는 것이 아니라, 메소드 호출을 통해 접근하게 된다. 그림으로 보면 다음과 같이 상상해 볼 수 있다.</p><p><img src=2021-09-18-15-52-24.png alt></p><p>Descriptor 라는 특별한 개념이 없다면, 코드 상으로는 객체가 위 그림과 비슷한 형태로 구성될 것이라고 예측할 수 있다. <code>Person</code> 안에 <code>Age</code> 객체가, 그리고 <code>Age</code> 객체 안에 <code>_age</code> 라는 멤버변수, <code>__getter__</code>, <code>__setter__</code> 라는 메소드를 가질 뿐이다. 따라서 <code>p.age</code> 로 접근하게 되면 <code>Age()</code> 객체로 접근할 것처럼 보인다. 하지만 실질적으로는 다음 그림과 같다.</p><p><img src=2021-09-18-15-56-29.png alt></p><p><code>p.age</code>를 호출하게 되는 순간, <code>Person</code> 객체 내에 있는 <code>Age()</code> 객체를 가져오려 하는데, <code>__get__</code> 메소드가 오버라이드 되어 실질적으로는 <code>Age()</code> 객체가 아닌 그 내부의 <code>self._age</code>를 돌려주게 된다.</p><p>이러한 동작 방식을 보고나면, 왜 <code>Data Descriptor</code> 라는 이름을 갖게 되었는지 알 수 있다. <code>Data Descriptor</code>로 정의된 객체는, 일반적으로 생각하는 것처럼 값을 갖고 메소드라는 행위를 갖지 않고, 대신 내가 원하는 <code>Data</code>(여기서는 _age라는 int 변수)에 대한 톨게이트와 같은 역할을 하게 된다.</p><h1 id=4-property>4. Property</h1><p>장황한 이야기를 끝내고, 드디어 Property에 대한 이야기를 해보자. 앞서 보여드렸던 Property 사용 예시는 다음과 같다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, name, age) :
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_name <span style=color:#f92672>=</span> name
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@property</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@age.setter</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self, new_age) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> new_age <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> :
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;나이는 0 이하가 될 수 없다.&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> new_age
</span></span></code></pre></div><p>Decorator에 대해서 이해하고 왔으니, <code>@property</code> 라는 코드를 통해, <code>property</code> 라는 함수(함수는 다시 객체이니 정확히는 <code>property</code>라는 객체)로 <code>age</code> 라는 메소드를 전달한다는 사실을 알 수 있다.</p><p>따라서, 아래와 같은 코드는</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#a6e22e>@property</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>( <span style=color:#f92672>...</span> ) :
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span></code></pre></div><p>실질적으로는 다음과 같다고 볼 수 있다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>age <span style=color:#f92672>=</span> property(age)
</span></span></code></pre></div><p>아까전에 <code>def my_func()</code> 라는 코드는 <code>my_func = {함수바디}</code>와 같이 변수로 정의되는 것을 상상해볼 수 있다고 이야기 했다. 여기서도 같은 맥락임을 확인할 수 있는데, 왜냐하면, <code>@property</code> 데코레이터를 사용해 <code>age = property(age)</code>로, 즉 클래스 변수로 만들었기 때문이다. (Descriptor는 반드시 클래스 변수에 있어야 한다는 사실을 상기하자.)</p><p><a href=https://docs.python.org/3/howto/descriptor.html>파이썬 공식 문서</a>에 있는 <code>property</code>의 생김새는 다음과 같다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Property</span>:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Emulate PyProperty_Type() in Objects/descrobject.c&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, fget<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>, fset<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>, fdel<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>, doc<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>fget <span style=color:#f92672>=</span> fget
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>fset <span style=color:#f92672>=</span> fset
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>fdel <span style=color:#f92672>=</span> fdel
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> doc <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span> <span style=color:#f92672>and</span> fget <span style=color:#f92672>is</span> <span style=color:#f92672>not</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            doc <span style=color:#f92672>=</span> fget<span style=color:#f92672>.</span>__doc__
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>__doc__ <span style=color:#f92672>=</span> doc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __get__(self, obj, objtype<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> obj <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> self
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>fget <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>AttributeError</span>(<span style=color:#e6db74>&#34;unreadable attribute&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>fget(obj)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __set__(self, obj, value):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>fset <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>AttributeError</span>(<span style=color:#e6db74>&#34;can&#39;t set attribute&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>fset(obj, value)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __delete__(self, obj):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>fdel <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>AttributeError</span>(<span style=color:#e6db74>&#34;can&#39;t delete attribute&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>fdel(obj)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>getter</span>(self, fget):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> type(self)(fget, self<span style=color:#f92672>.</span>fset, self<span style=color:#f92672>.</span>fdel, self<span style=color:#f92672>.</span>__doc__)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>setter</span>(self, fset):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> type(self)(self<span style=color:#f92672>.</span>fget, fset, self<span style=color:#f92672>.</span>fdel, self<span style=color:#f92672>.</span>__doc__)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>deleter</span>(self, fdel):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> type(self)(self<span style=color:#f92672>.</span>fget, self<span style=color:#f92672>.</span>fset, fdel, self<span style=color:#f92672>.</span>__doc__)
</span></span></code></pre></div><p>자, 이제 어떻게 코드가 동작하는지에 대해서 이해할 준비가 되었으니, 한 줄씩 따라가보며 총 정리해보자.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#a6e22e>@property</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>( <span style=color:#f92672>...</span> ) :
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span></code></pre></div><p>위 코드를 통해 <code>age = property(age)</code> 가 실행된다고 언급했다. <code>property</code>의 생성자 인자로 <code>age</code>라는 메소드를 넘겨줬으니, 이 age는 <code>__init__</code> 메소드 내부에서 <code>fget</code> 이라는 변수에 할당됨을 확인할 수 있다. 그리고 <code>@property</code>를 적용한 <code>Person</code> 클래스의 현재 생김새는 다음과 같다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, name, age) :
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_name <span style=color:#f92672>=</span> name
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> age
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_age
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    age <span style=color:#f92672>=</span> property(age)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@age.setter</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self, new_age) :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> new_age <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> :
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;나이는 0 이하가 될 수 없다.&#34;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> new_age
</span></span></code></pre></div><p>다음으로 <code>@age.setter</code> 부분을 살펴보자. 현재 <code>age</code>는 <code>property</code> 객체인 상태다. 그러면 <code>@age.setter</code>는 다음과 같이 해석된다. age가 계속 나와 헷갈리니 주석을 참고하자.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>age <span style=color:#f92672>=</span> property(age)
</span></span><span style=display:flex><span><span style=color:#75715e># age(1번) = property(age(2번))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># age 라는 이름의 변수(1번)에 &#39;age 메소드&#39;(2번)를 인자로 넘긴 property 객체를 저장.</span>
</span></span><span style=display:flex><span>age <span style=color:#f92672>=</span> age<span style=color:#f92672>.</span>setter(age) 
</span></span><span style=display:flex><span><span style=color:#75715e># age(3) = age(1).setter(age(4))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># age라는 이름의 변수(3번)에, property 객체를 갖고 있는 age 변수(1번)의 setter 메소드에 새로운 age 메소드(4)를 넘겨준다.</span>
</span></span></code></pre></div><p>그리고 <code>setter</code> 메소드를 살펴보면,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>setter</span>(self, fset):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> type(self)(self<span style=color:#f92672>.</span>fget, fset, self<span style=color:#f92672>.</span>fdel, self<span style=color:#f92672>.</span>__doc__)
</span></span></code></pre></div><p><code>type(self)</code> 부분은 자기 자신에 대한 <code>type</code>을 구하고 있다. <code>self</code>는 <code>property</code> 이니 다음과 같이 해석된다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>setter</span>(self, fset):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> property(self<span style=color:#f92672>.</span>fget, fset, self<span style=color:#f92672>.</span>fdel, self<span style=color:#f92672>.</span>__doc__)
</span></span></code></pre></div><p>자기 자신에 대해서 생성자를 호출하고 있다. 꼭 마치 자바에서 생성자에 <code>this()</code>와 비슷해 보인다. 또한, 나머지는 <code>self</code> 키워드를 붙여서 자기 자신이 갖고 있던 녀석들을 넘겨주고, <code>fset</code> 위치에만 <code>age(self, new_age)</code> 라는 메소드를 넘겨주고 있다.</p><p>이제 <code>Person</code> 객체에서 <code>age</code>를 접근할 때 무슨일이 일어날까? <code>p.age</code> 로 꺼낸 <code>age</code>는 <code>property</code> 객체라는 사실은 이 쯤 되면 잘 알 것이다. <code>property</code> 객체는 연이어 <code>__get__</code> 메소드를 호출할 것이다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> __get__(self, obj, objtype<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> obj <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>fget <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>AttributeError</span>(<span style=color:#e6db74>&#34;unreadable attribute&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>fget(obj)
</span></span></code></pre></div><p><code>__get__</code> 메소드의 인자 <code>obj</code>는 자기 자신을 실행한 인스턴스, <code>objtype</code>은 해당 클래스를 의미한다. <code>p.age</code>로 인스턴스를 통해 실행했으니 <code>obj</code>는 p일 것이고, <code>objtype</code> 은 <code>Person</code> 이다.<br><code>obj</code>가 <code>None</code>이 아니고, <code>fget</code> 또한 아까 할당되었으니, <code>return self.fget(obj)</code>가 실행된다.</p><p>즉, <code>fget(obj)</code> 의 fget은 앞서 정의한 <code>def age(self)</code> 이니, 아까 내가 정의한 <code>getter</code> 메소드, 즉 다음 메소드가 실행된다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self) :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>_age
</span></span></code></pre></div><p>다음으로 <code>__set__</code> 메소드를 살펴보자. <code>p.age = -10</code> 이라고 작성했다면, 역시 <code>p.age</code> 변수가 갖고 있는 객체는 <code>property</code> 객체이고, 해당 객체의 <code>__set__</code> 메소드가 호출된다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> __set__(self, obj, value):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>fset <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>AttributeError</span>(<span style=color:#e6db74>&#34;can&#39;t set attribute&#34;</span>)
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>fset(obj, value)
</span></span></code></pre></div><p>마찬가지로 obj는 자기 자신을 실행한 인스턴스, 즉 <code>p</code> 이고, <code>value</code>는 <code>-10</code> 입니다. <code>fset</code> 변수는 앞서 할당한 <code>def age(self, new_age)</code> 함수 객체이고, None이 아니니 <code>self.fset(obj, value)</code>를 실행한다. 즉, 다음 메소드가 실행된다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>age</span>(self, new_age) :
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> new_age <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span> :
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;나이는 0 이하가 될 수 없다.&#34;</span>)
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>_age <span style=color:#f92672>=</span> new_age
</span></span></code></pre></div><hr><h2 id=reference>Reference</h2><ul><li><a href=https://shoark7.github.io/programming/python/closure-in-python>Python의 Closure에 대해 알아보자</a></li><li><a href=https://wikidocs.net/81226>Wikidocs 레벨업 파이썬 - 클로저</a></li><li><a href=https://docs.python.org/3/howto/descriptor.html>Python 공식문서 - Descriptor</a></li><li><a href=https://kukuta.tistory.com/339>Hardcore in Programming - Descriptor</a></li><li><a href=https://m.blog.naver.com/r00tdr4g0n/222056023801>[Python 지식]- Descriptor 우선순위</a></li></ul></section><footer class="mt-12 flex flex-wrap"><a class="mb-1.5 mr-1.5 rounded-lg bg-black/[3%] px-5 py-1.5 no-underline dark:bg-white/[8%]" href=https://cjlee.io/blog/tags/null>null</a></footer><nav class="mt-24 flex rounded-lg bg-black/[3%] text-lg dark:bg-white/[8%]"><a class="flex w-1/2 items-center rounded-l-md p-6 pr-3 font-semibold no-underline hover:bg-black/[2%] dark:hover:bg-white/[3%]" href=https://cjlee.io/blog/post/kotlin-property/><span class=mr-1.5>←</span><span>kotlin property</span></a></nav></article></main><footer class="opaco mx-auto flex h-[4.5rem] max-w-3xl items-center px-8 text-[0.9em] opacity-60"><div class=mr-auto>&copy; 2024
<a class=link href=https://cjlee.io/blog/>cjlee38</a></div><a class="link mx-6" href=https://gohugo.io/ rel=noopener target=_blank>Powered by Hugo️️</a>️
<a class=link href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>✎ Paper</a></footer></body></html>